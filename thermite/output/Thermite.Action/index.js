// Generated by psc-make version 0.6.2
"use strict";
var Prelude = require("Prelude");
var Thermite_Internal = require("Thermite.Internal");
var Control_Monad_Eff = require("Control.Monad.Eff");
function GetState(value0) {
    this.value0 = value0;
};
GetState.create = function (value0) {
    return new GetState(value0);
};
function SetState(value0, value1) {
    this.value0 = value0;
    this.value1 = value1;
};
SetState.create = function (value0) {
    return function (value1) {
        return new SetState(value0, value1);
    };
};
function Wait(value0) {
    this.value0 = value0;
};
Wait.create = function (value0) {
    return new Wait(value0);
};
function Pure(value0) {
    this.value0 = value0;
};
Pure.create = function (value0) {
    return new Pure(value0);
};
function Impure(value0) {
    this.value0 = value0;
};
Impure.create = function (value0) {
    return new Impure(value0);
};
var setState = function (s) {
    return Impure.create(new SetState(s, new Pure(Prelude.unit)));
};
var runAction = function (ctx) {
    var go = function (_38) {
        if (_38 instanceof Pure) {
            return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
        };
        if (_38 instanceof Impure && _38.value0 instanceof GetState) {
            return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
                var _2 = Thermite_Internal.getStateImpl(ctx)();
                return go(_38.value0.value0(_2))();
            });
        };
        if (_38 instanceof Impure && _38.value0 instanceof SetState) {
            return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
                Thermite_Internal.setStateImpl(ctx)(_38.value0.value0)();
                return go(_38.value0.value1)();
            });
        };
        if (_38 instanceof Impure && _38.value0 instanceof Wait) {
            return _38.value0.value0(go);
        };
        throw new Error("Failed pattern match");
    };
    return go;
};
var getState = Impure.create(new GetState(Pure.create));
var functorActionF = new Prelude.Functor(function (_36) {
    return function (_37) {
        if (_37 instanceof GetState) {
            return new GetState(Prelude["<<<"](Prelude.semigroupoidArr)(_36)(_37.value0));
        };
        if (_37 instanceof SetState) {
            return new SetState(_37.value0, _36(_37.value1));
        };
        if (_37 instanceof Wait) {
            return new Wait(function (k_1) {
                return _37.value0(Prelude["<<<"](Prelude.semigroupoidArr)(k_1)(_36));
            });
        };
        throw new Error("Failed pattern match");
    };
});
var functorAction = new Prelude.Functor(function (_39) {
    return function (_40) {
        if (_40 instanceof Pure) {
            return new Pure(_39(_40.value0));
        };
        if (_40 instanceof Impure) {
            return new Impure(Prelude["<$>"](functorActionF)(Prelude["<$>"](functorAction)(_39))(_40.value0));
        };
        throw new Error("Failed pattern match");
    };
});
var async = function (c) {
    return Impure.create(new Wait(function (k) {
        return c(Prelude["<<<"](Prelude.semigroupoidArr)(k)(Pure.create));
    }));
};
var sync = function (e) {
    return async(Prelude[">>="](Control_Monad_Eff.bindEff)(e));
};
var monadAction = new Prelude.Monad(function () {
    return applicativeAction;
}, function () {
    return bindAction;
});
var bindAction = new Prelude.Bind(function (_41) {
    return function (_42) {
        if (_41 instanceof Pure) {
            return _42(_41.value0);
        };
        if (_41 instanceof Impure) {
            return Impure.create(Prelude["<#>"](functorActionF)(_41.value0)(function (a_1) {
                return Prelude[">>="](bindAction)(a_1)(_42);
            }));
        };
        throw new Error("Failed pattern match");
    };
}, function () {
    return applyAction;
});
var applyAction = new Prelude.Apply(Prelude.ap(monadAction), function () {
    return functorAction;
});
var applicativeAction = new Prelude.Applicative(function () {
    return applyAction;
}, Pure.create);
var asyncSetState = function (c) {
    return Prelude[">>="](bindAction)(async(c))(function (_4) {
        return setState(_4);
    });
};
var modifyState = function (f) {
    return Prelude[">>="](bindAction)(getState)(function (_3) {
        return setState(f(_3));
    });
};
module.exports = {
    applicativeAction: applicativeAction, 
    applyAction: applyAction, 
    async: async, 
    asyncSetState: asyncSetState, 
    bindAction: bindAction, 
    functorAction: functorAction, 
    getState: getState, 
    modifyState: modifyState, 
    monadAction: monadAction, 
    runAction: runAction, 
    setState: setState, 
    sync: sync
};
