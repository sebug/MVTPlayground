// Generated by psc-make version 0.6.2
"use strict";
var Thermite = require("Thermite");
var Thermite_Html_Elements = require("Thermite.Html.Elements");
var Thermite_Html = require("Thermite.Html");
var Thermite_Html_Attributes = require("Thermite.Html.Attributes");
var Thermite_Events = require("Thermite.Events");
var Prelude = require("Prelude");
var API_User = require("API.User");
var Thermite_Action = require("Thermite.Action");
var Data_Either = require("Data.Either");
function SetFirstName(value0) {
    this.value0 = value0;
};
SetFirstName.create = function (value0) {
    return new SetFirstName(value0);
};
function SetLastName(value0) {
    this.value0 = value0;
};
SetLastName.create = function (value0) {
    return new SetLastName(value0);
};
function SaveUser(value0) {
    this.value0 = value0;
};
SaveUser.create = function (value0) {
    return new SaveUser(value0);
};
function LoadUser() {

};
LoadUser.value = new LoadUser();
function getValue(e) {  return e.target.value;};
var saveSetState = function (u) {
    return function (f) {
        return API_User.saveUser(u)(function (res) {
            if (res instanceof Data_Either.Left) {
                return f({
                    user: new API_User.User({
                        firstName: "Error", 
                        name: "Error", 
                        address: "Error", 
                        age: 0
                    })
                });
            };
            if (res instanceof Data_Either.Right) {
                return f({
                    user: u
                });
            };
            throw new Error("Failed pattern match");
        });
    };
};
var loadSetState = function (f) {
    return API_User.loadUser(Prelude.unit)(function (res) {
        if (res instanceof Data_Either.Left) {
            return f({
                user: new API_User.User({
                    firstName: "Error", 
                    name: "Error", 
                    address: "Error", 
                    age: 0
                })
            });
        };
        if (res instanceof Data_Either.Right) {
            var _10 = API_User.parseUser(res.value0);
            if (_10 instanceof Data_Either.Left) {
                return f({
                    user: new API_User.User({
                        firstName: "Parse Error", 
                        name: "Parse Error", 
                        address: "Parse Error", 
                        age: 0
                    })
                });
            };
            if (_10 instanceof Data_Either.Right) {
                return f({
                    user: new API_User.User(_10.value0.value0)
                });
            };
            throw new Error("Failed pattern match");
        };
        throw new Error("Failed pattern match");
    });
};
var performAction = function (_3) {
    return function (_4) {
        if (_4 instanceof LoadUser) {
            return Thermite_Action.asyncSetState(loadSetState);
        };
        if (_4 instanceof SaveUser) {
            return Thermite_Action.asyncSetState(saveSetState(_4.value0));
        };
        if (_4 instanceof SetFirstName) {
            return Thermite_Action.modifyState(function (st) {
                return {
                    user: new API_User.User({
                        firstName: _4.value0, 
                        name: st.user.value0.name, 
                        address: st.user.value0.address, 
                        age: st.user.value0.age
                    })
                };
            });
        };
        if (_4 instanceof SetLastName) {
            return Thermite_Action.modifyState(function (st) {
                return {
                    user: new API_User.User({
                        firstName: st.user.value0.firstName, 
                        name: _4.value0, 
                        address: st.user.value0.address, 
                        age: st.user.value0.age
                    })
                };
            });
        };
        throw new Error("Failed pattern match");
    };
};
var initialState = {
    user: new API_User.User({
        firstName: "", 
        name: "", 
        address: "", 
        age: 0
    })
};
var handleLastNameChangeEvent = function (e) {
    return new SetLastName(getValue(e));
};
var handleChangeEvent = function (e) {
    return new SetFirstName(getValue(e));
};
var render = function (_0) {
    return function (_1) {
        return function (_2) {
            return Thermite_Html_Elements["div'"]([ Thermite_Html_Elements["div'"]([ Thermite_Html.text("First name"), Thermite_Html_Elements.input([ Thermite_Html_Attributes.value(_1.user.value0.firstName), Thermite_Events.onChange(_0)(handleChangeEvent) ])([  ]) ]), Thermite_Html_Elements["div'"]([ Thermite_Html.text("Last name"), Thermite_Html_Elements.input([ Thermite_Html_Attributes.value(_1.user.value0.name), Thermite_Events.onChange(_0)(handleLastNameChangeEvent) ])([  ]) ]), Thermite_Html_Elements.button([ Thermite_Events.onClick(_0)(Prelude["const"](new SaveUser(_1.user))) ])([ Thermite_Html.text("Save User") ]) ]);
        };
    };
};
var spec = Thermite.componentWillMount(LoadUser.value)(Thermite.simpleSpec(initialState)(performAction)(render));
var main = (function () {
    var cl = Thermite.createClass(spec);
    return Thermite.render(cl)(Prelude.unit);
})();
module.exports = {
    LoadUser: LoadUser, 
    SaveUser: SaveUser, 
    SetFirstName: SetFirstName, 
    SetLastName: SetLastName, 
    getValue: getValue, 
    handleChangeEvent: handleChangeEvent, 
    handleLastNameChangeEvent: handleLastNameChangeEvent, 
    initialState: initialState, 
    loadSetState: loadSetState, 
    main: main, 
    performAction: performAction, 
    render: render, 
    saveSetState: saveSetState, 
    spec: spec
};
